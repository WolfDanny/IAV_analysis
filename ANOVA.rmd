---
title: "R Notebook"
output: html_document
---
```{r Loading absolute numbers}

WT <- read.csv("WT.csv")
T8A <- read.csv("T8A.csv")
N3A <- read.csv("N3A.csv")
```
```{r Lists}
time_names <- list("Primary", "Memory", "WT challenge", "T8A challenge", "N3A challenge")
time_file_names <- list("P", "M", "WT", "T8A", "N3A")
cd45 <- list("Cir", "Res", "Cir", "Res")
organ <- list("S", "S", "L", "L")
```
```{r WT priming absolute numbers}

WTWT <- stack(WT[WT$Challenge == "WT",], select=-Challenge)
aovWTWT <- aov(values ~ ind, WTWT)
tukeyWTWT <- TukeyHSD(aovWTWT, ordered=TRUE, conf.level=0.95)
# plot(tukeyWTWT , las=1 , col="green")

WTT8A <- stack(WT[WT$Challenge == "T8A",], select=-Challenge)
aovWTT8A <- aov(values ~ ind, WTT8A)
tukeyWTT8A <- TukeyHSD(aovWTT8A, ordered=TRUE, conf.level=0.95)
# plot(tukeyWTT8A , las=1 , col="green")

WTN3A <- stack(WT[WT$Challenge == "N3A",], select=-Challenge)
aovWTN3A <- aov(values ~ ind, WTN3A)
tukeyWTN3A <- TukeyHSD(aovWTN3A, ordered=TRUE, conf.level=0.95)
# plot(tukeyWTN3A , las=1 , col="green")
```
```{r WT priming frequencies}

file_names <- list("WT-S-Cir-F.csv", "WT-S-Res-F.csv", "WT-L-Cir-F.csv", "WT-L-Res-F.csv")

for (file_index in 1:4){
  Data <- read.csv(file_names[[file_index]])

  for (time_index in 1:5){
    Timepoint <- stack(Data[Data$Challenge == time_names[time_index],], select=-Challenge)
    aovTimepoint <- aov(values ~ ind, Timepoint)
    tukeyTimepoint <- TukeyHSD(aovTimepoint, ordered=TRUE, conf.level=0.95)
    write.csv(as.data.frame(tukeyTimepoint[1]), paste0("ANOVA/WT/Tukey-",time_file_names[[time_index]],"-",organ[[file_index]],"-",cd45[[file_index]],".csv"))
  }
}
```
```{r T8A priming absolute numbers}

T8AWT <- stack(T8A[T8A$Challenge == "WT",], select=-Challenge)
aovT8AWT <- aov(values ~ ind, T8AWT)
tukeyT8AWT <- TukeyHSD(aovT8AWT, ordered=TRUE, conf.level=0.95)
# plot(tukeyT8AWT , las=1 , col="green")

T8AT8A <- stack(T8A[T8A$Challenge == "T8A",], select=-Challenge)
aovT8AT8A <- aov(values ~ ind, T8AT8A)
tukeyT8AT8A <- TukeyHSD(aovT8AT8A, ordered=TRUE, conf.level=0.95)
# plot(tukeyT8AT8A , las=1 , col="green")

T8AN3A <- stack(T8A[T8A$Challenge == "N3A",], select=-Challenge)
aovT8AN3A <- aov(values ~ ind, T8AN3A)
tukeyT8AN3A <- TukeyHSD(aovT8AN3A, ordered=TRUE, conf.level=0.95)
# plot(tukeyT8AN3A , las=1 , col="green")
```
```{r T8A priming frequencies}

file_names <- list("T8A-S-Cir-F.csv", "T8A-S-Res-F.csv", "T8A-L-Cir-F.csv", "T8A-L-Res-F.csv")

for (file_index in 1:4){
  Data <- read.csv(file_names[[file_index]])

  for (time_index in 1:5){
    Timepoint <- stack(Data[Data$Challenge == time_names[time_index],], select=-Challenge)
    aovTimepoint <- aov(values ~ ind, Timepoint)
    tukeyTimepoint <- TukeyHSD(aovTimepoint, ordered=TRUE, conf.level=0.95)
    write.csv(as.data.frame(tukeyTimepoint[1]), paste0("ANOVA/T8A/Tukey-",time_file_names[[time_index]],"-",organ[[file_index]],"-",cd45[[file_index]],".csv"))
  }
}
```
```{r Tests}

Data <- read.csv("T8A-S-Cir-F.csv")
Timepoint <- stack(Data[Data$Challenge == "Memory",], select=-Challenge)
aovTimepoint <- aov(values ~ ind, Timepoint)
tukeyTimepoint <- TukeyHSD(aovTimepoint, ordered=TRUE, conf.level=0.95)

Data2 <- read.csv("T8A-L-Res-F.csv")
Timepoint2 <- stack(Data2[Data2$Challenge == "T8A challenge",], select=-Challenge)
aovTimepoint2 <- aov(values ~ ind, Timepoint2)
tukeyTimepoint2 <- TukeyHSD(aovTimepoint2, ordered=TRUE, conf.level=0.95)

Data3 <- read.csv("WT-L-Cir-F.csv")
Timepoint3 <- stack(Data3[Data3$Challenge == "Primary",], select=-Challenge)
aovTimepoint3 <- aov(values ~ ind, Timepoint3)
tukeyTimepoint3 <- TukeyHSD(aovTimepoint3, ordered=TRUE, conf.level=0.95)
```
```{r N3A priming absolute numbers}

N3AWT <- stack(N3A[N3A$Challenge == "WT",], select=-Challenge)
aovN3AWT <- aov(values ~ ind, N3AWT)
tukeyN3AWT <- TukeyHSD(aovN3AWT, ordered=TRUE, conf.level=0.95)
# plot(tukeyN3AWT , las=1 , col="green")

N3AT8A <- stack(N3A[N3A$Challenge == "T8A",], select=-Challenge)
aovN3AT8A <- aov(values ~ ind, N3AT8A)
tukeyN3AT8A <- TukeyHSD(aovN3AT8A, ordered=TRUE, conf.level=0.95)
# plot(tukeyN3AT8A , las=1 , col="green")

N3AN3A <- stack(N3A[N3A$Challenge == "N3A",], select=-Challenge)
aovN3AN3A <- aov(values ~ ind, N3AN3A)
tukeyN3AN3A <- TukeyHSD(aovN3AN3A, ordered=TRUE, conf.level=0.95)
# plot(tukeyN3AN3A , las=1 , col="green")
```
```{r N3A priming frequencies}

file_names <- list("N3A-S-Cir-F.csv", "N3A-S-Res-F.csv", "N3A-L-Cir-F.csv", "N3A-L-Res-F.csv")

for (file_index in 1:4){
  Data <- read.csv(file_names[[file_index]])

  for (time_index in 1:5){
    Timepoint <- stack(Data[Data$Challenge == time_names[time_index],], select=-Challenge)
    aovTimepoint <- aov(values ~ ind, Timepoint)
    tukeyTimepoint <- TukeyHSD(aovTimepoint, ordered=TRUE, conf.level=0.95)
    write.csv(as.data.frame(tukeyTimepoint[1]), paste0("ANOVA/N3A/Tukey-",time_file_names[[time_index]],"-",organ[[file_index]],"-",cd45[[file_index]],".csv"))
  }
}
```
